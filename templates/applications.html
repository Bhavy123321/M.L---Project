<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LoanSense - Applications List</title>
  <style>
    body{margin:0;font-family:Arial;background:#0b1220;color:#e5e7eb}
    .nav{display:flex;justify-content:space-between;align-items:center;padding:16px 22px;background:#0f172a;border-bottom:1px solid #1f2937}
    .brand{font-weight:800;font-size:20px;letter-spacing:.5px}
    .nav a{color:#e5e7eb;text-decoration:none;background:#2563eb;padding:10px 14px;border-radius:10px}
    .wrap{max-width:1100px;margin:30px auto;padding:0 16px}
    h1{margin:0 0 8px;font-size:26px}
    p{margin:0 0 18px;color:#9ca3af}
    table{width:100%;border-collapse:collapse;background:#0f172a;border:1px solid #1f2937;border-radius:16px;overflow:hidden}
    th,td{padding:12px;border-bottom:1px solid #1f2937;text-align:center}
    th{background:#111c33;color:#cbd5e1;font-size:13px;text-transform:uppercase;letter-spacing:.6px}
    tr:hover td{background:#0b1220}
    .badge{padding:6px 10px;border-radius:999px;font-weight:800;font-size:12px;display:inline-block}
    .approved{background:#052e1a;color:#bbf7d0;border:1px solid #14532d}
    .rejected{background:#3b0a0a;color:#fecaca;border:1px solid #7f1d1d}
    .btnDel{background:#ef4444;color:#fff;border:none;padding:8px 10px;border-radius:10px;cursor:pointer}
    .btnDel:hover{filter:brightness(.95)}
    .flash{margin:0 0 14px;padding:12px;border-radius:12px}
    .flash.success{background:#052e1a;color:#bbf7d0;border:1px solid #14532d}
    .empty{padding:20px;text-align:center;color:#94a3b8}
    @media(max-width:800px){
      table{display:block;overflow-x:auto;white-space:nowrap}
    }
  </style>
</head>
<body>

  <div class="nav">
    <div class="brand">LoanSense</div>
    <a href="/">+ Add New</a>
  </div>

  <div class="wrap">
    <h1>All Entered Data</h1>
    <p>Below is the list of all submitted applications.</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, msg in messages %}
          <div class="flash {{ category }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <table>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Income</th>
        <th>Credit Score</th>
        <th>Loan Amount</th>
        <th>Result</th>
        <th>Created</th>
        <th>Action</th>
      </tr>

      {% if data|length == 0 %}
        <tr>
          <td class="empty" colspan="8">No data found. Add a new application from “+ Add New”.</td>
        </tr>
      {% else %}
        {% for row in data %}
          <tr>
            <td>{{ row.id }}</td>
            <td>{{ row.name }}</td>
            <td>{{ row.income }}</td>
            <td>{{ row.credit_score }}</td>
            <td>{{ row.loan_amount }}</td>
            <td>
              {% if row.result == "Approved" %}
                <span class="badge approved">Approved</span>
              {% else %}
                <span class="badge rejected">Rejected</span>
              {% endif %}
            </td>
            <td>{{ row.created_at }}</td>
            <td>
              <form action="/delete/{{ row.id }}" method="POST" onsubmit="return confirm('Delete this record?')">
                <button class="btnDel" type="submit">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      {% endif %}
    </table>
  </div>

</body>
</html>
